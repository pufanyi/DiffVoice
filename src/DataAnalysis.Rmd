---
title: "Data Analysis"
knit: (function(inputFile, encoding) {
      out_dir <- "../docs/";
      rmarkdown::render(inputFile,
                        encoding=encoding,
                        output_dir=file.path(dirname(inputFile), out_dir))})
output:
  html_document:
    theme: journal
    toc: true
    toc_float: true
---

## Load Data

```{r}
data_path = "../data/train.csv"
voice = read.csv(data_path)
head(voice)
```

## MeanFreq

### Basic Analysis

We firstly load the data and draw a histogram of the `meanfreq` column.

```{r}
meanfreq = voice$meanfreq
hist(meanfreq)
```

Then, we calculate the mean and standard deviation of the `meanfreq` column.

```{r}
#hist of meanfreq
hist(meanfreq, breaks = 80, main = "Histogram of meanfreq", xlab = "meanfreq")
#impose a normal curve on the histogram
xpt = seq(698, 7056, by = 0.1)
n_den = dnorm(xpt, mean = mean(meanfreq), sd = sd(meanfreq))
ypt = n_den * length(meanfreq) * 100
lines(xpt, ypt, col = "red")
```

#### QQ plot for meanfreq

```{r}
# QQplot of meanfreq
qqnorm(meanfreq)
qqline(meanfreq, col = "blue")
title("QQplot for meanfreq", line = 1)  # Place title on the first line
```

#### shapiro test

```{r}
#shapiro test-sample must be less than 5000. Therefore, we will take a sample of 5000 for 100 times
pvalue = numeric(100)
for (i in 1:100) {
  meanfreq_sample <- sample(meanfreq, 5000)
  shapiro.test(meanfreq_sample)
  pvalue[i] <- shapiro.test(meanfreq_sample)$p.value
}
pvalue > 0.05
```

Therefore, the data is not normally distributed.

### log-transformation

```{r}
meanfreq_log <- log(meanfreq)
hist(meanfreq_log, breaks = 80, main = "Histogram of log(meanfreq)", xlab = "log(meanfreq)")
range(meanfreq_log)
#impose a normal curve on the histogram
xpt = seq(6, 9, by = 0.1)
n_den = dnorm(xpt, mean = mean(meanfreq_log), sd = sd(meanfreq_log))
ypt = n_den * length(meanfreq_log) * 0.05
lines(xpt, ypt, col = "red")
```

#### QQ plot for log-transformed meanfreq

```{r}
qqnorm(meanfreq_log)
qqline(meanfreq_log, col = "red")
title("QQplot for meanfreq-log", line = 1)  # Place title on the first line
```

## SD

### Basic Analysis

We firstly load the data and draw a histogram of the `sd` column.

```{r}
sd = voice$sd
hist(sd)
```

```{r}
hist(sd, breaks = 80, main = "Histogram of sd", xlab = "sd")
#impose a normal curve on the histogram
xpt = seq(402, 4203, by = 0.1)
n_den = dnorm(xpt, mean = mean(sd), sd = sd(sd))
ypt = n_den * length(sd) * 50
lines(xpt, ypt, col = "red")
```

```{r}
qqnorm(sd)
qqline(sd, col = "blue")
```


### log-transformation

```{r}
#log-transformation of sd
sd_log <- log(sd)
hist(sd_log, breaks = 80, main = "Histogram of log(sd)", xlab = "log(sd)")
```

```{r}
qqnorm(sd_log)
qqline(sd_log, col = "red")
```

We found that after log-transformation, the data is even worse than before. 

Therefore, we tried another way: $y=\log(x + 3000)$

```{r}
sd_log <- log(sd + 3000)
hist(sd_log, breaks = 80, main = "Histogram of log(sd)", xlab = "log(sd)")
```

```{r}
hist(sd_log, breaks = 80, main = "Histogram of log(sd)", xlab = "log(sd)", probability = TRUE)
curve(dnorm(x, mean = mean(sd_log), sd = sd(sd_log)), col = "red", lwd = 2, add = TRUE)
```


```{r}
qqnorm(sd_log)
qqline(sd_log, col = "red")
```

## Median

### Basic Analysis

We firstly load the data and draw a histogram of the `median` column.

```{r}
median = voice$median
hist(median, breaks = 80, main = "Histogram of median", xlab = "median")
```

Then, we calculate the mean and standard deviation of the `median` column.

```{r}
median_mean <- mean(median)
median_sd <- sd(median)
```

```{r}
hist(median, breaks = 80, main = "Histogram of median", xlab = "median", probability = TRUE)
curve(dnorm(x, mean = median_mean, sd = median_sd), col = "red", lwd = 2, add = TRUE)
```

```{r}
qqnorm(median)
qqline(median, col = "blue")
```

### log-transformation

```{r}
median_log_without_outliers = log(median_without_outliers)
hist(median_log_without_outliers, breaks = 80, main = "Histogram of log(median)", xlab = "log(median)")
```

```{r}
hist(median_log_without_outliers, breaks = 80, main = "Histogram of log(median)", xlab = "log(median)", probability = TRUE)
curve(dnorm(x, mean = mean(median_log_without_outliers), sd = sd(median_log_without_outliers)), col = "red", lwd = 2, add = TRUE)
```

```{r}
qqnorm(median_log_without_outliers)
qqline(median_log_without_outliers, col = "red")
```

## Q25

### Basic Analysis

We firstly load the data and draw a histogram of the `Q25` column.

```{r}
Q25 = voice$Q25
hist(Q25, breaks = 80, main = "Histogram of Q25", xlab = "Q25")
```

Then, we calculate the mean and standard deviation of the `Q25` column.

```{r}
Q25_mean <- mean(Q25)
Q25_sd <- sd(Q25)
```

```{r}
hist(Q25, breaks = 80, main = "Histogram of Q25", xlab = "Q25", probability = TRUE)
curve(dnorm(x, mean = Q25_mean, sd = Q25_sd), col = "red", lwd = 2, add = TRUE)
```

#### QQ plot for Q25

```{r}
qqnorm(Q25)
qqline(Q25, col = "blue")
```

### log-transformation

After multiple attempts to transform the `Q25` column, we found that the log-transformation with $f(x)=\log(x - \min(x) + 70)$ is the best transformation for this column.

```{r}
Q25_log <- log(Q25 - min(Q25) + 70)
hist(Q25_log, breaks = 80, main = "Histogram of log(Q25)", xlab = "log(Q25)")
```

```{r}
hist(Q25_log, breaks = 80, main = "Histogram of log(Q25)", xlab = "log(Q25)", probability = TRUE)
curve(dnorm(x, mean = mean(Q25_log), sd = sd(Q25_log)), col = "red", lwd = 2, add = TRUE)
```


```{r}
qqnorm(Q25_log)
qqline(Q25_log, col = "red")
```

### Remove Outliers

```{r}
IQR = IQR(Q25_log)
outlr = c(abs(Q25_log - mean(Q25_log)) > 1.5 * IQR)
#append the outliers and id to the data
outlr_id = voice$id[outlr]
Q25_without_outliers = Q25_log[!outlr]
```

Then, we save the IDs of the outliers to a CSV file.

```{r}
write.csv(outlr_id, "../data/outliers/Q25.csv", row.names = FALSE)
```

Then, we draw the histogram and QQ plot for the log-transformed `Q25` column without the outliers.

```{r}
hist(Q25_without_outliers, breaks = 80, main = "Histogram of log(Q25) without Outliers", xlab = "log(Q25)", probability = TRUE)
curve(dnorm(x, mean = mean(Q25_without_outliers), sd = sd(Q25_without_outliers)), col = "red", lwd = 2, add = TRUE)
```

```{r}
qqnorm(Q25_without_outliers)
qqline(Q25_without_outliers, col = "red")
```


## Q75

We firstly load the data and draw a histogram of the `Q75` column.

```{r}
Q75 = voice$Q75
hist(Q75)
```

Then, we calculate the mean and standard deviation of the `Q75` column.

```{r}
Q75_mean <- mean(Q75)
Q75_sd <- sd(Q75)
print(paste("Mean of Q75:", Q75_mean))
print(paste("Standard deviation of Q75:", Q75_sd))
```

#### Histogram with overlaid normal curve

```{r}
hist(Q75, probability = TRUE, main = "Histogram of Q75 with Normal Curve", xlab = "Q75")
curve(dnorm(x, mean = Q75_mean, sd = Q75_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

#### QQ plot

```{r}
qqnorm(Q75, main = "QQ Plot of Q75")
qqline(Q75, col = "steelblue", lwd = 2)
```

### Log-transformed `Q75`

```{r}
Q75_log <- log(Q75 + 5000)
hist(Q75_log, breaks = 20, main = "Histogram of log(Q75)", xlab = "log(Q75)")
Q75_log_mean <- mean(Q75_log)
Q75_log_sd <- sd(Q75_log)
print(paste("Mean of log-transformed Q75:", Q75_log_mean))
print(paste("Standard deviation of log-transformed Q75:", Q75_log_sd))
```

#### Histogram with overlaid normal curve

```{r}
hist(Q75_log, probability = TRUE, main = "Histogram of log-transformed Q75 with Normal Curve", xlab = "log(Q75)")
curve(dnorm(x, mean = Q75_log_mean, sd = Q75_log_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

#### QQ plot for log-transformed `Q75`

```{r}
qqnorm(Q75_log, main = "QQ Plot for log-transformed Q75")
qqline(Q75_log, col = "red")
```


### Removing Outliers

```{r}
Q1 <- quantile(Q75_log, 0.25)
Q3 <- quantile(Q75_log, 0.75)
iqr <- Q3 - Q1
lower_bound <- Q1 - 1.5 * iqr
upper_bound <- Q3 + 1.5 * iqr
outliers <- Q75_log < lower_bound | Q75_log > upper_bound
outlier_ids <- data.frame(id = voice$id[outliers])
Q75_log_no_outliers <- Q75_log[!outliers]
```

Then, we save the IDs of the outliers to a CSV file.

```{r}
write.csv(outlier_ids, "../data/outliers/Q75.csv", row.names = FALSE)
```

Then, we draw the histogram and QQ plot for the `Q75` column without the outliers.

```{r}
hist(Q75_log_no_outliers, breaks = 20, main = "Histogram of log-transformed Q75 without Outliers", xlab = "Q75")
Q75_log_no_outliers_mean <- mean(Q75_log_no_outliers)
Q75_log_no_outliers_sd <- sd(Q75_log_no_outliers)
print(paste("Mean of log-transformed Q75 without outliers:", Q75_log_no_outliers_mean))
print(paste("Standard deviation of log-transformed Q75 without outliers:", Q75_log_no_outliers_sd))
```

```{r}
hist(Q75_log_no_outliers, probability = TRUE, main = "Histogram of log-transformed Q75 without Outliers with Normal Curve", xlab = "log-transformed Q75", breaks = 100)
curve(dnorm(x, mean = Q75_log_no_outliers_mean, sd = Q75_log_no_outliers_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

```{r}
qqnorm(Q75_log_no_outliers, main = "QQ Plot for log-transformed Q75 without outliers")
qqline(Q75_log_no_outliers, col = "red")
```

## IQR

```{r}
IQR = voice$IQR
hist(IQR)
```

Then, we calculate the mean and standard deviation of the `IQR` column.

```{r}
IQR_mean <- mean(IQR)
IQR_sd <- sd(IQR)
```

The `IQR` column is almost normally distributed, we can see that from the histogram and QQ plot below.

```{r}
hist(IQR, probability = TRUE, main = "Histogram of IQR with Normal Curve", xlab = "IQR", breaks = 20)
curve(dnorm(x, mean = IQR_mean, sd = IQR_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

```{r}
qqnorm(IQR, main = "QQ Plot of IQR")
qqline(IQR, col = "steelblue", lwd = 2)
```

### Removing Outliers

```{r}
Q1 <- quantile(IQR, 0.25)
Q3 <- quantile(IQR, 0.75)
iqr <- Q3 - Q1
lower_bound <- Q1 - 1.5 * iqr
upper_bound <- Q3 + 1.5 * iqr
outliers <- IQR < lower_bound | IQR > upper_bound
outlier_ids <- data.frame(id = voice$id[outliers])
IQR_no_outliers <- IQR[!outliers]
```

Then, we save the IDs of the outliers to a CSV file.

```{r}
write.csv(outlier_ids, "../data/outliers/IQR.csv", row.names = FALSE)
```

Then, we draw the histogram and QQ plot for the `IQR` column without the outliers.

```{r}
hist(IQR_no_outliers, breaks = 20, main = "Histogram of IQR without Outliers", xlab = "IQR")
IQR_no_outliers_mean <- mean(IQR_no_outliers)
IQR_no_outliers_sd <- sd(IQR_no_outliers)
print(paste("Mean of IQR without outliers:", IQR_no_outliers_mean))
print(paste("Standard deviation of IQR without outliers:", IQR_no_outliers_sd))
```

```{r}
hist(IQR_no_outliers, probability = TRUE, main = "Histogram of IQR without Outliers with Normal Curve", xlab = "IQR", breaks = 20)
curve(dnorm(x, mean = IQR_no_outliers_mean, sd = IQR_no_outliers_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

```{r}
qqnorm(IQR_no_outliers, main = "QQ Plot for IQR without outliers")
qqline(IQR_no_outliers, col = "red")
```


## skew

```{r}
skew = voice$skew
hist(skew)
```

Then, we calculate the mean and standard deviation of the `skew` column.

```{r}
skew_mean <- mean(skew)
skew_sd <- sd(skew)
```

The `skew` column is almost normally distributed, we can see that from the histogram and QQ plot below.

```{r}
hist(skew, probability = TRUE, main = "Histogram of skew with Normal Curve", xlab = "IQR", breaks = 20)
curve(dnorm(x, mean = skew_mean, sd = skew_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

```{r}
qqnorm(skew, main = "QQ Plot of skew")
qqline(skew, col = "steelblue", lwd = 2)
```

### Removing Outliers

```{r}
Q1 <- quantile(skew, 0.25)
Q3 <- quantile(skew, 0.75)
iqr <- Q3 - Q1
lower_bound <- Q1 - 1.5 * iqr
upper_bound <- Q3 + 1.5 * iqr
outliers <- skew < lower_bound | skew > upper_bound
outlier_ids <- data.frame(id = voice$id[outliers])
skew_no_outliers <- skew[!outliers]
```

Then, we save the IDs of the outliers to a CSV file.

```{r}
write.csv(outlier_ids, "../data/outliers/skew.csv", row.names = FALSE)
```

Then, we draw the histogram and QQ plot for the `skew` column without the outliers.

```{r}
hist(skew_no_outliers, breaks = 20, main = "Histogram of skew without Outliers", xlab = "skew")
skew_no_outliers_mean <- mean(skew_no_outliers)
skew_no_outliers_sd <- sd(skew_no_outliers)
print(paste("Mean of skew without outliers:", skew_no_outliers_mean))
print(paste("Standard deviation of skew without outliers:", skew_no_outliers_sd))
```

```{r}
hist(skew_no_outliers, probability = TRUE, main = "Histogram of skew without Outliers with Normal Curve", xlab = "skew", breaks = 20)
curve(dnorm(x, mean = skew_no_outliers_mean, sd = skew_no_outliers_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

```{r}
qqnorm(skew_no_outliers, main = "QQ Plot for skew without outliers")
qqline(skew_no_outliers, col = "red")
```


## kurt

```{r}
kurt = voice$kurt
hist(kurt, breaks = 80, main = "Histogram of kurt", xlab = "kurt")
```

Then, we calculate the mean and standard deviation of the `kurt` column.

```{r}
kurt_mean <- mean(kurt)
kurt_sd <- sd(kurt)
```

The `kurt` column is almost normally distributed, we can see that from the histogram and QQ plot below.

```{r}
hist(kurt, probability = TRUE, main = "Histogram of kurt with Normal Curve", xlab = "kurt", breaks = 80)
curve(dnorm(x, mean = kurt_mean, sd = kurt_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

```{r}
qqnorm(kurt, main = "QQ Plot of kurt")
qqline(kurt, col = "steelblue", lwd = 2)
```

### Log-transformed `kurt`

```{r}
kurt_log <- log(kurt + 0.31)
hist(kurt_log, breaks = 80, main = "Histogram of log(kurt)", xlab = "log(kurt)")
kurt_log_mean <- mean(kurt_log)
kurt_log_sd <- sd(kurt_log)
print(paste("Mean of log-transformed kurt:", kurt_log_mean))
print(paste("Standard deviation of log-transformed kurt:", kurt_log_sd))
```

#### Histogram with overlaid normal curve

```{r}
hist(kurt_log, probability = TRUE, main = "Histogram of log-transformed Kurt with Normal Curve", xlab = "log(kurt)", breaks = 80)
curve(dnorm(x, mean = kurt_log_mean, sd = kurt_log_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

#### QQ plot for log-transformed `kurt`

```{r}
qqnorm(kurt_log, main = "QQ Plot for log-transformed kurt")
qqline(kurt_log, col = "red")
```


### Removing Outliers

```{r}
Q1 <- quantile(kurt_log, 0.25)
Q3 <- quantile(kurt_log, 0.75)
iqr <- Q3 - Q1
lower_bound <- Q1 - 1.5 * iqr
upper_bound <- Q3 + 1.5 * iqr
outliers <- kurt_log < lower_bound | kurt_log > upper_bound
outlier_ids <- data.frame(id = voice$id[outliers])
kurt_log_no_outliers <- kurt_log[!outliers]
```

Then, we save the IDs of the outliers to a CSV file.

```{r}
write.csv(outlier_ids, "../data/outliers/kurt.csv", row.names = FALSE)
```

Then, we draw the histogram and QQ plot for the `kurt` column without the outliers.

```{r}
hist(kurt_log_no_outliers, breaks = 20, main = "Histogram of log-transformed kurt without Outliers", xlab = "kurt")
kurt_log_no_outliers_mean <- mean(kurt_log_no_outliers)
kurt_log_no_outliers_sd <- sd(kurt_log_no_outliers)
print(paste("Mean of log-transformed kurt without outliers:", kurt_log_no_outliers_mean))
print(paste("Standard deviation of log-transformed kurt without outliers:", kurt_log_no_outliers_sd))
```

```{r}
hist(kurt_log_no_outliers, probability = TRUE, main = "Histogram of log-transformed kurt without Outliers with Normal Curve", xlab = "log-transformed kurt", breaks = 20)
curve(dnorm(x, mean = kurt_log_no_outliers_mean, sd = kurt_log_no_outliers_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

```{r}
qqnorm(kurt_log_no_outliers, main = "QQ Plot for log-transformed kurt without outliers")
qqline(kurt_log_no_outliers, col = "red")
```


## Centroid

### Basic Analysis

We firstly load the data and draw a histogram of the `centroid` column.

```{r}
centroid = voice$centroid
hist(centroid)
```

Then, we calculate the mean and standard deviation of the `centroid` column.

```{r}
centroid_mean <- mean(centroid)
centroid_sd <- sd(centroid)
print(paste("Mean of centroid:", centroid_mean))
print(paste("Standard deviation of centroid:", centroid_sd))
```

#### Histogram with overlaid normal curve

```{r}
hist(centroid, probability = TRUE, main = "Histogram of Centroid with Normal Curve", xlab = "Centroid")
curve(dnorm(x, mean = centroid_mean, sd = centroid_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

#### QQ plot

```{r}
qqnorm(centroid, main = "QQ Plot of Centroid")
qqline(centroid, col = "steelblue", lwd = 2)
```

### Log-transformed `centroid`

```{r}
centroid_log <- log(centroid)
hist(centroid_log, breaks = 20, main = "Histogram of log(centroid)", xlab = "log(centroid)")
centroid_log_mean <- mean(centroid_log)
centroid_log_sd <- sd(centroid_log)
print(paste("Mean of log-transformed centroid:", centroid_log_mean))
print(paste("Standard deviation of log-transformed centroid:", centroid_log_sd))
```

#### Histogram with overlaid normal curve

```{r}
hist(centroid_log, probability = TRUE, main = "Histogram of log-transformed Centroid with Normal Curve", xlab = "log(centroid)")
curve(dnorm(x, mean = centroid_log_mean, sd = centroid_log_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

#### QQ plot for log-transformed `centroid`

```{r}
qqnorm(centroid_log, main = "QQ Plot for log-transformed centroid")
qqline(centroid_log, col = "red")
```

### Removing Outliers

```{r}
IQR <- IQR(centroid_log)
outliers <- !(centroid_log > (centroid_log_mean - 1.5 * IQR) & centroid_log < (centroid_log_mean + 1.5 * IQR))
outlier_ids <- data.frame(id = voice$id[outliers])
centroid_log_no_outliers <- centroid_log[!outliers]
```

Then, we save the IDs of the outliers to a CSV file.

```{r}
write.csv(outlier_ids, "../data/outliers/centroid.csv", row.names = FALSE)
```

Then, we draw the histogram and QQ plot for the log-transformed `centroid` column without the outliers.

```{r}
hist(centroid_log_no_outliers, breaks = 20, main = "Histogram of log-transformed Centroid without Outliers", xlab = "log(centroid)")
centroid_log_no_outliers_mean <- mean(centroid_log_no_outliers)
centroid_log_no_outliers_sd <- sd(centroid_log_no_outliers)
print(paste("Mean of log-transformed centroid without outliers:", centroid_log_no_outliers_mean))
print(paste("Standard deviation of log-transformed centroid without outliers:", centroid_log_no_outliers_sd))
```

```{r}
hist(centroid_log_no_outliers, probability = TRUE, main = "Histogram of log-transformed Centroid without Outliers with Normal Curve", xlab = "log(centroid)", breaks = 20)
curve(dnorm(x, mean = centroid_log_no_outliers_mean, sd = centroid_log_no_outliers_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

```{r}
qqnorm(centroid_log_no_outliers, main = "QQ Plot for log-transformed centroid without outliers")
qqline(centroid_log_no_outliers, col = "red")
```

## MeanFun

### Basic Analysis

```{r}
meanfun = voice$meanfun
hist(meanfun)
```

Then, we calculate the mean and standard deviation of the `meanfun` column.

```{r}
meanfun_mean <- mean(meanfun)
meanfun_sd <- sd(meanfun)
```

It is very obvious that the `meanfun` column is not normally distributed, we can see that from the histogram and QQ plot below.

```{r}
hist(meanfun, probability = TRUE, main = "Histogram of MeanFun with Normal Curve", xlab = "MeanFun", breaks = 20)
curve(dnorm(x, mean = meanfun_mean, sd = meanfun_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

```{r}
qqnorm(meanfun, main = "QQ Plot of MeanFun")
qqline(meanfun, col = "steelblue", lwd = 2)
```

### Log-transformed `meanfun`

```{r}
meanfun_log <- log(meanfun)
hist(meanfun_log, breaks = 20, main = "Histogram of log(meanfun)", xlab = "log(meanfun)")
```

```{r}
meanfun_log_mean <- mean(meanfun_log)
meanfun_log_sd <- sd(meanfun_log)
print(paste("Mean of log-transformed meanfun:", meanfun_log_mean))
print(paste("Standard deviation of log-transformed meanfun:", meanfun_log_sd))
```

```{r}
hist(meanfun_log, probability = TRUE, main = "Histogram of log-transformed MeanFun with Normal Curve", xlab = "log(meanfun)", breaks = 20)
curve(dnorm(x, mean = meanfun_log_mean, sd = meanfun_log_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

```{r}
qqnorm(meanfun_log, main = "QQ Plot for log-transformed meanfun")
qqline(meanfun_log, col = "red")
```

### Removing Outliers

```{r}
IQR <- IQR(meanfun_log)
outliers <- !(meanfun_log > (meanfun_log_mean - 1.5 * IQR) & meanfun_log < (meanfun_log_mean + 1.5 * IQR))
outlier_ids <- data.frame(id = voice$id[outliers])
meanfun_log_no_outliers <- meanfun_log[!outliers]
```

Then, we save the IDs of the outliers to a CSV file.

```{r}
write.csv(outlier_ids, "../data/outliers/meanfun.csv", row.names = FALSE)
```

Then, we draw the histogram and QQ plot for the log-transformed `meanfun` column without the outliers.

```{r}
hist(meanfun_log_no_outliers, breaks = 20, main = "Histogram of log-transformed MeanFun without Outliers", xlab = "log(meanfun)")
meanfun_log_no_outliers_mean <- mean(meanfun_log_no_outliers)
meanfun_log_no_outliers_sd <- sd(meanfun_log_no_outliers)
print(paste("Mean of log-transformed meanfun without outliers:", meanfun_log_no_outliers_mean))
print(paste("Standard deviation of log-transformed meanfun without outliers:", meanfun_log_no_outliers_sd))
```

```{r}
hist(meanfun_log_no_outliers, probability = TRUE, main = "Histogram of log-transformed MeanFun without Outliers with Normal Curve", xlab = "log(meanfun)", breaks = 20)
curve(dnorm(x, mean = meanfun_log_no_outliers_mean, sd = meanfun_log_no_outliers_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

```{r}
qqnorm(meanfun_log_no_outliers, main = "QQ Plot for log-transformed meanfun without outliers")
qqline(meanfun_log_no_outliers, col = "red")
```

## MeanDom

### Basic Analysis
 
```{r}
meandom = voice$meandom
hist(meandom, breaks = 80, main = "Histogram of meandom", xlab = "meandom")
```

Then, we calculate the mean and standard deviation of the `meandom` column.

```{r}
meandom_mean <- mean(meandom)
meandom_sd <- sd(meandom)
```

We then draw the histogram and QQ plot for the `meandom` column to know more about its distribution.

```{r}
hist(meandom, probability = TRUE, main = "Histogram of MeanDom with Normal Curve", xlab = "MeanDom", breaks = 80)
curve(dnorm(x, mean = meandom_mean, sd = meandom_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

```{r}
qqnorm(meandom, main = "QQ Plot of MeanDom")
qqline(meandom, col = "steelblue", lwd = 2)
```

### log-transformed `meandom`

After multiple attempts to transform the `meandom` column, we found that the log-transformation with $f(x)=\log(x + 0.01)$ is the best transformation for this column.

```{r}
meandom_log <- log(meandom + 0.01)
hist(meandom_log, breaks = as.integer(sqrt(length(meandom_log))), main = "Histogram of log(meandom)", xlab = "log(meandom)")
```

```{r}
meandom_log_mean <- mean(meandom_log)
meandom_log_sd <- sd(meandom_log)
print(paste("Mean of log-transformed meandom:", meandom_log_mean))
print(paste("Standard deviation of log-transformed meandom:", meandom_log_sd))
```

```{r}
hist(meandom_log, probability = TRUE, main = "Histogram of log-transformed MeanDom with Normal Curve", xlab = "log(meandom)", breaks = as.integer(sqrt(length(meandom_log))))
curve(dnorm(x, mean = meandom_log_mean, sd = meandom_log_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

```{r}
qqnorm(meandom_log, main = "QQ Plot for log-transformed meandom")
qqline(meandom_log, col = "red")
```


### Removing Outliers

```{r}
IQR = IQR(meandom_log)
outliers <- !(meandom_log > (meandom_log_mean - 1.5 * IQR) & meandom_log < (meandom_log_mean + 1.5 * IQR))
outlier_ids <- data.frame(id = voice$id[outliers])
meandom_log_no_outliers <- meandom_log[!outliers]
```

Then, we save the IDs of the outliers to a CSV file.

```{r}
write.csv(outlier_ids, "../data/outliers/meandom.csv", row.names = FALSE)
```

Then, we draw the histogram and QQ plot for the sqrt-transformed `meandom` column without the outliers.

```{r}
hist(meandom_log_no_outliers, breaks = as.integer(sqrt(length(meandom_log_no_outliers))), main = "Histogram of log-transformed MeanDom without Outliers", xlab = "log(meandom)")
meandom_log_no_outliers_mean <- mean(meandom_log_no_outliers)
meandom_log_no_outliers_sd <- sd(meandom_log_no_outliers)
print(paste("Mean of log-transformed meandom without outliers:", meandom_log_no_outliers_mean))
print(paste("Standard deviation of log-transformed meandom without outliers:", meandom_log_no_outliers_sd))
```

```{r}
hist(meandom_log_no_outliers, probability = TRUE, main = "Histogram of log-transformed MeanDom without Outliers with Normal Curve", xlab = "sqrt(meandom)", breaks = as.integer(sqrt(length(meandom_log_no_outliers))))
curve(dnorm(x, mean = meandom_log_no_outliers_mean, sd = meandom_log_no_outliers_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

```{r}
qqnorm(meandom_log_no_outliers, main = "QQ Plot for log-transformed meandom without outliers")
qqline(meandom_log_no_outliers, col = "red")
```

## MinDom

### Basic Analysis

```{r}
mindom = voice$mindom
hist(mindom)
```

Then, we calculate the mean and standard deviation of the `mindom` column.

```{r}
mindom_mean <- mean(mindom)
mindom_sd <- sd(mindom)
```

We then draw the histogram and QQ plot for the `mindom` column to know more about its distribution.

```{r}
hist(mindom, probability = TRUE, main = "Histogram of MinDom with Normal Curve", xlab = "MinDom", breaks = 20)
curve(dnorm(x, mean = mindom_mean, sd = mindom_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

```{r}
qqnorm(mindom, main = "QQ Plot of MinDom")
qqline(mindom, col = "steelblue", lwd = 2)
```

### log-transformed `mindom`

```{r}
mindom_log <- log(mindom)
hist(mindom_log, breaks = as.integer(sqrt(length(mindom_log))), main = "Histogram of log(mindom)", xlab = "log(mindom)")
```

```{r}
mindom_log_mean <- mean(mindom_log)
mindom_log_sd <- sd(mindom_log)
print(paste("Mean of log-transformed mindom:", mindom_log_mean))
print(paste("Standard deviation of log-transformed mindom:", mindom_log_sd))
```

```{r}
hist(mindom_log, probability = TRUE, main = "Histogram of log-transformed MinDom with Normal Curve", xlab = "log(mindom)", breaks = as.integer(sqrt(length(mindom_log))))
curve(dnorm(x, mean = mindom_log_mean, sd = mindom_log_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

```{r}
qqnorm(mindom_log, main = "QQ Plot for log-transformed mindom")
qqline(mindom_log, col = "red")
```

### Removing Outliers

```{r}
outliers <- !(mindom_log > (mindom_log_mean - 3 * mindom_log_sd) & mindom_log < (mindom_log_mean + 3 * mindom_log_sd))
outlier_ids <- data.frame(id = voice$id[outliers])
mindom_log_no_outliers <- mindom_log[!outliers]
```

Then, we save the IDs of the outliers to a CSV file.

```{r}
write.csv(outlier_ids, "../data/outliers/mindom.csv", row.names = FALSE)
```

Then, we draw the histogram and QQ plot for the sqrt-transformed `mindom` column without the outliers.

```{r}
hist(mindom_log_no_outliers, breaks = as.integer(sqrt(length(mindom_log_no_outliers))), main = "Histogram of log-transformed MinDom without Outliers", xlab = "log(mindom)")
mindom_log_no_outliers_mean <- mean(mindom_log_no_outliers)
mindom_log_no_outliers_sd <- sd(mindom_log_no_outliers)
print(paste("Mean of log-transformed mindom without outliers:", mindom_log_no_outliers_mean))
print(paste("Standard deviation of log-transformed mindom without outliers:", mindom_log_no_outliers_sd))
```

```{r}
hist(mindom_log_no_outliers, probability = TRUE, main = "Histogram of log-transformed MinDom without Outliers with Normal Curve", xlab = "sqrt(mindom)", breaks = as.integer(sqrt(length(mindom_log_no_outliers))))
curve(dnorm(x, mean = mindom_log_no_outliers_mean, sd = mindom_log_no_outliers_sd), col = "darkblue", lwd = 2, add = TRUE, yaxt = "n")
```

```{r}
qqnorm(mindom_log_no_outliers, main = "QQ Plot for log-transformed mindom without outliers")
qqline(mindom_log_no_outliers, col = "red")
```

## MaxDom

## Gender

```{r}
gender = voice$gender
pie(table(gender), main = "Pie Chart of Gender Distribution")
```

