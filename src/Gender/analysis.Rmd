---
title: "Analysis"
knit: (function(inputFile, encoding) {
      out_dir <- "../docs/gender";
      rmarkdown::render(inputFile,
                        encoding=encoding,
                        output_dir=file.path(dirname(inputFile), out_dir))})
output:
  html_document:
    theme: journal
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
MALE_COLOR = rgb(0, 0, 1, 0.2)
FEMALE_COLOR = rgb(1, 0, 0, 0.2)
```

# Data Preparation

```{r}
voice = read.csv("../../data/gender/balanced_train.csv")
head(voice)
```

```{r}
male_data = voice[voice$gender == 'male', ]
female_data = voice[voice$gender == "female", ]
head(male_data)
head(female_data)
```

# Data Analysis

## Gender

```{r}
pie(table(voice$gender), main = "Male and Female")
```

```{r}
visualize_data <- function(column) {
  # return(male_data[column])
  hist(male_data[[column]], col = MALE_COLOR, prob = TRUE, breaks = 80, border = "white", main = sprintf("Histogram and KDE of %s", column))
  hist(female_data[[column]], col = FEMALE_COLOR, prob = TRUE, add = TRUE, breaks = 80, border = "white")
  
  # Calculate and plot KDE for male data
  male_density <- density(male_data[[column]])
  lines(male_density, col = "blue", lwd = 2)
  
  # Calculate and plot KDE for female data
  female_density <- density(female_data[[column]])
  lines(female_density, col = "red", lwd = 2)
  
  legend("topright", legend = c("Male", "Female"), col = c("blue", "red"), lwd = 2, fill = c(MALE_COLOR, FEMALE_COLOR))
}
```


## Mean Frequency

### Visualizing the data

We first visualize the data by plotting the histogram 

```{r}
visualize_data("meanfreq")
```
### QQ-plot

We then plot the QQ-plot to check for normality

```{r}
qqnorm(male_data$meanfreq)
qqline(male_data$meanfreq, col = "red")


qqnorm(female_data$meanfreq)
qqline(female_data$meanfreq, col = "red")
```
Based on the QQ-plot, we can see that the data is normally distributed. We would therefore use the F test to compare the variance of the data

### F-test

```{r}
var.test(male_data$meanfreq, female_data$meanfreq)
```
Since the p-value is less than 0.05, we reject the null hypothesis that the variance of the data is the same, we would therefore use the two sample t-test with unequal variance

### Two Sample T-test

```{r}
t.test(male_data$meanfreq, female_data$meanfreq, var.equal = FALSE)
```
Since the p-value is greater than 0.05, we do not reject the null hypothesis that the mean of the data is the same

## Q25

### Visualizing the data

We first visualize the data by plotting the histogram 

```{r}
visualize_data("Q25")
```

### QQ-plot

We then plot the QQ-plot to check for normality

```{r}
qqnorm(male_data$Q25)
qqline(male_data$Q25, col = "red")


qqnorm(female_data$Q25)
qqline(female_data$Q25, col = "red")
```
Based on the QQ-plot, we can see that the data is not normally distributed. We would therefore use the Wilcoxon test to compare the mean of the data

### Wilcoxon Test

```{r}
wilcox.test(male_data$Q25, female_data$Q25, alt = "less")
```
The p-value is less than 0.05, we reject the null hypothesis that the mean of the data is the same

## Q75

### Visualizing the data

We first visualize the data by plotting the histogram 

```{r}
visualize_data("Q75")
```
### QQ-plot

We then plot the QQ-plot to check for normality

```{r}
qqnorm(male_data$Q75)
qqline(male_data$Q75, col = "red")


qqnorm(female_data$Q75)
qqline(female_data$Q75, col = "red")
```
Based on the QQ-plot, we can see that the data is not normally distributed. We would therefore use the Wilcoxon test to compare the mean of the data

### Wilcoxon Test

```{r}
wilcox.test(male_data$Q75, female_data$Q75, alt = "less")
```
The p-value is more than 0.05, we do not reject the null hypothesis that the mean of the data is the same
